<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Portal - Nagar Mitra</title>
    <link rel="stylesheet" href="adminD.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Real Time complaint PopUp -->
     <h2>Admin Dashboard</h2>
    <div id="complaints"></div>

    <!-- Header -->
    <header class="admin-header">
        <div class="header-container">
            <button class="hamburger-menu" id="hamburgerMenu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <div class="header-emblems">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Emblem_of_India.svg/250px-Emblem_of_India.svg.png" alt="Government of India" class="emblem">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Swachh_Bharat_Mission_logo.svg/250px-Swachh_Bharat_Mission_logo.svg.png" alt="Swachh Bharat Mission" class="emblem">
            </div>
            
            <div class="header-title">
                <h1>Nagar Mitra</h1>
                <span class="admin-badge">Admin Dashboard</span>
            </div>
            
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </header>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-content">
            <div class="sidebar-menu">
                <a href="#" class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="menu-item" data-section="complaints">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Complaints</span>
                </a>
                <a href="#" class="menu-item" data-section="departments">
                    <i class="fas fa-building"></i>
                    <span>Departments</span>
                </a>
                <a href="#" class="menu-item" data-section="analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>Analytics</span>
                </a>
                <a href="#" class="menu-item" data-section="team">
                    <i class="fas fa-users"></i>
                    <span>Team</span>
                </a>
                <a href="#" class="menu-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Live Counter -->
        <section class="counter-section">
            <div class="counter-cards">
                <div class="counter-card">
                    <div class="counter-icon">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="counter-info">
                        <h3 id="activeComplaints">247</h3>
                        <p>Total Active Complaints</p>
                    </div>
                </div>
                
                <div class="counter-card">
                    <div class="counter-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="counter-info">
                        <h3 id="inProgressComplaints">89</h3>
                        <p>Complaints in Progress</p>
                    </div>
                </div>
                
                <div class="counter-card">
                    <div class="counter-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="counter-info">
                        <h3 id="resolvedComplaints">1532</h3>
                        <p>Total Resolved Complaints</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Map and Complaints Section -->
        <section class="map-complaints-section">
            <div class="map-container">
                <div class="map-header">
                    <h2>Live City Map</h2>
                    <div class="map-controls">
                        <button class="map-btn" id="fullscreenBtn">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="map-btn" id="refreshMapBtn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="map-wrapper">
                    <div id="liveMap" class="live-map"></div>
                    <div class="map-legend">
                        <div class="legend-item">
                            <div class="legend-marker urgent"></div>
                            <span>Urgent</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-marker normal"></div>
                            <span>Normal</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-marker low"></div>
                            <span>Low Priority</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="complaints-container">
                <div class="complaints-header">
                    <h2>Recent Complaints</h2>
                    <div class="filter-controls">
                        <select id="categoryFilter" class="form-control">
                            <option value="">All Categories</option>
                            <option value="Electricity">Electricity</option>
                            <option value="Water">Water</option>
                            <option value="Sewer">Sewer</option>
                            <option value="Roads and Infrastructure">Roads & Infrastructure</option>
                            <option value="Sanitation">Sanitation</option>
                            <option value="Public Works">Public Works</option>
                        </select>
                        <select id="priorityFilter" class="form-control">
                            <option value="">All Priority</option>
                            <option value="Urgent">Urgent</option>
                            <option value="Normal">Normal</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>
                </div>
                
                <div class="complaints-list" id="complaintsList">
                    <!-- Complaint cards will be dynamically inserted here -->
                </div>
            </div>
        </section>

        <!-- Department Grid -->
        <section class="departments-section">
            <h2 style="color: black;">Department Overview</h2>
            <div class="departments-grid" id="departmentsGrid">
                <!-- Department cards will be dynamically inserted -->
            </div>
        </section>

        <!-- Admin Features -->
        <section class="admin-features">
            <div class="features-grid">
                <!-- Performance Metrics -->
                <div class="feature-card">
                    <div class="feature-header">
                        <h3>Performance Metrics</h3>
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="chart-container" style="position: relative; height: 200px;">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="feature-card">
                    <div class="feature-header">
                        <h3>Recent Activity</h3>
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="activity-log" id="activityLog">
                        <!-- Activity items will be added dynamically -->
                    </div>
                </div>

                <!-- Team Management -->
                <div class="feature-card">
                    <div class="feature-header">
                        <h3>Team Management</h3>
                        <i class="fas fa-users-cog"></i>
                    </div>
                    <div class="team-stats">
                        <div class="team-stat">
                            <span class="stat-number">12</span>
                            <span class="stat-label">Active Admins</span>
                        </div>
                        <div class="team-stat">
                            <span class="stat-number">45</span>
                            <span class="stat-label">Department Officers</span>
                        </div>
                        <div class="team-stat">
                            <span class="stat-number">6</span>
                            <span class="stat-label">Supervisors</span>
                        </div>
                    </div>
                    <button class="btn btn--primary btn--sm">Manage Team</button>
                </div>

                <!-- Communication Hub -->
                <div class="feature-card">
                    <div class="feature-header">
                        <h3>Communication Hub</h3>
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <div class="communication-options">
                        <button class="comm-btn">
                            <i class="fas fa-envelope"></i>
                            <span>Send Email</span>
                        </button>
                        <button class="comm-btn">
                            <i class="fas fa-sms"></i>
                            <span>SMS Alert</span>
                        </button>
                        <button class="comm-btn">
                            <i class="fas fa-bell"></i>
                            <span>Push Notification</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="quick-actions">
            <h2 style="color: black;">Quick Actions</h2>
            <div class="actions-grid">
                <button class="action-btn">
                    <i class="fas fa-tasks"></i>
                    <span>Bulk Assign</span>
                </button>
                <button class="action-btn">
                    <i class="fas fa-file-export"></i>
                    <span>Export Reports</span>
                </button>
                <button class="action-btn">
                    <i class="fas fa-bullhorn"></i>
                    <span>Broadcast Update</span>
                </button>
                <button class="action-btn">
                    <i class="fas fa-chart-pie"></i>
                    <span>Analytics</span>
                </button>
            </div>
        </section>
    </main>

    <!-- Complaint Action Modal -->
    <div class="modal hidden" id="complaintActionModal">
        <div class="modal__backdrop"></div>
        <div class="modal__content">
            <div class="modal__header">
                <h3 id="modalTitle">Complaint Action</h3>
                <button class="modal__close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal__body" id="modalBody">
                <!-- Content will be dynamically populated -->
            </div>
            <div class="modal__footer" id="modalFooter">
                <!-- Footer buttons will be dynamically populated -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast hidden" id="toast">
        <div class="toast-content">
            <i class="toast-icon"></i>
            <span class="toast-message"></span>
        </div>
        <button class="toast-close">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

    // Firebase Web Config
    const firebaseConfig = {
      apiKey: "AIzaSyBEJOP9E6Cvy55ZRrXcKrAysBraarOQOVU",
      authDomain: "http://crowd-sourced-civic-issu-d615e.firebaseapp.com",
      projectId: "crowd-sourced-civic-issu-d615e",
      storageBucket: "http://crowd-sourced-civic-issu-d615e.firebasestorage.app",
      messagingSenderId: "787152121870",
      appId: "1:787152121870:web:268cb84dc4520acf6d8c5f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const notifRef = collection(db, "notifications");

    // Real-time listener
    onSnapshot(notifRef, (snapshot) => {
      snapshot.docChanges().forEach((change) => {
        if (change.type === "added") {
          const data = change.doc.data();
          alert("ðŸ“¢ New complaint: " + data.message);
          
          // Optional: show in page
          const div = document.getElementById("complaints");
          const p = document.createElement("p");
          p.textContent = data.message;
          div.appendChild(p);
        }
      });
    });
  </script>
   -->
  <div id="notification-container"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script src="adminD.js"></script>
</body>
</html>